name: testing

on: [push]

jobs:
  test:
    runs-on: ubuntu-18.04
    steps:
      - name: Dump github
        run: echo "${{ toJSON(github) }}"
      - name: Dump context
        uses: actions/github-script@0.2.0
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            return context;
      - name: Script
        uses: actions/github-script@0.2.0
        with:
          github-token: ${{ secrets.GITHUB_TOKEN }}
          script: |
            const { data { message } } = await github.git.getTag({
                owner: context.payload.repository.owner.name,
                repo: context.payload.repository.name,
                tag_sha: context.payload.after
            });
            return message;
        #uses: rectalogic/notify-irc@v1
        if: github.event_name == 'push' && startsWith(github.ref, 'refs/tags/')
        #run: |
        #  git for-each-ref ${{ github.ref }} --format='%(contents)'
      - name: Dump step
        run: echo "${{ toJSON(steps) }}"
